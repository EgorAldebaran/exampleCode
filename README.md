Этот код с двух моих рабочих проектов, на большую часть мой собственный, однако подлежит NDA, поэтому пространства имен не указаны и код только для ознакомления. Он не запустится в таком виде.
Только для ознакомления.
